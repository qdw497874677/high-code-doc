# AGENT 规则

## 技术设计规则

### 概要设计规则

#### 内容规则

| 规则 | 说明 |
|------|------|
| 必须明确核心流程 | 主流程必须画清楚，分支可简化 |
| 必须说明决策理由 | 技术选型、架构决策必须写"为什么" |
| 必须界定系统边界 | 明确做什么、不做什么 |
| 必须识别主要风险 | 至少列出 3 个风险及应对 |

#### 简化规则

| 可省略 | 说明 |
|--------|------|
| 详细字段定义 | 只列核心字段，类型可省略 |
| 完整接口定义 | 只列接口清单，参数可省略 |
| 精确性能指标 | 方向性目标即可，如"响应时间 < 1s" |
| 所有异常场景 | 只列主要异常，边界情况可推迟 |

#### 表达规则

1. **图优先**：能用图说明的不用文字
2. **表次之**：能用表格的不用段落
3. **文字最后**：只用于补充说明
4. **一页原则**：核心内容一页能看完
5. **先因后果**：先说"为什么"再讲"怎么做"

### 详细设计规则

#### 内容规则

| 规则 | 说明 |
|------|------|
| 必须可编码 | 细节程度足以直接写代码 |
| 必须完整定义接口 | 参数类型、必填、校验规则、错误码 |
| 必须完整定义表结构 | 字段、类型、约束、索引 |
| 必须有降级方案 | 核心功能必须有降级/回滚策略 |

#### 时机规则

1. **前置条件**：概要设计评审通过后才开始
2. **开发前完成**：详细设计完成才能开始编码
3. **同步更新**：代码变更时同步更新文档

#### 表达规则

1. **新人原则**：新人看文档能直接编码
2. **示例优先**：复杂逻辑配代码示例或伪代码
3. **变更记录**：每次修改记录变更内容

### 通用规则

#### 写作禁忌

| 禁止 | 原因 |
|------|------|
| 禁止无图的长篇文字 | 难以理解，难以评审 |
| 禁止模糊表述 | "适当优化"、"尽量快"等无意义 |
| 禁止过时内容 | 文档与代码不一致比没有文档更糟 |
| 禁止复制粘贴 | 每个项目有自己的上下文 |

#### 评审规则

| 阶段 | 评审重点 | 通过标准 |
|------|----------|----------|
| 概要设计 | 方向、决策、风险 | 方向正确、决策有据、风险可控 |
| 详细设计 | 可行性、完整性 | 可直接编码、无遗漏 |

#### 迭代规则

1. **概要设计**：需求变更时必须更新
2. **详细设计**：代码变更时必须同步
3. **版本管理**：重大变更保留历史版本
